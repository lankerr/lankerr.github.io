<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="HMM前向算法 (Forward Algorithm)初始化:$$\alpha_1(i) &#x3D; \pi_i b_i(o_1), 1 \leq i \leq N$$ 递推:$$\alpha_{t+1}(j) &#x3D; \left[ \sum_{i&#x3D;1}^N \alpha_t(i) a_{ij} \right] b_j(o_{t+1}), 1 \leq t \leq T-1, 1">
<meta property="og:type" content="article">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/2025/03/12/HMM-viterbi/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="HMM前向算法 (Forward Algorithm)初始化:$$\alpha_1(i) &#x3D; \pi_i b_i(o_1), 1 \leq i \leq N$$ 递推:$$\alpha_{t+1}(j) &#x3D; \left[ \sum_{i&#x3D;1}^N \alpha_t(i) a_{ij} \right] b_j(o_{t+1}), 1 \leq t \leq T-1, 1">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2025-03-12T14:37:33.047Z">
<meta property="article:modified_time" content="2025-03-23T07:18:54.543Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
<meta name="generator" content="Hexo 7.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"><span class="fa fa-bars"></span></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        
          <a class="nav-icon" href="/atom.xml" title="RSS Feed"><span class="fa fa-rss"></span></a>
        
        <a class="nav-icon nav-search-btn" title="Search"><span class="fa fa-search"></span></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-HMM-viterbi" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2025/03/12/HMM-viterbi/" class="article-date">
  <time class="dt-published" datetime="2025-03-12T14:37:33.047Z" itemprop="datePublished">2025-03-12</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="HMM前向算法-Forward-Algorithm"><a href="#HMM前向算法-Forward-Algorithm" class="headerlink" title="HMM前向算法 (Forward Algorithm)"></a>HMM前向算法 (Forward Algorithm)</h2><p><strong>初始化</strong>:<br>$$\alpha_1(i) &#x3D; \pi_i b_i(o_1), 1 \leq i \leq N$$</p>
<p><strong>递推</strong>:<br>$$\alpha_{t+1}(j) &#x3D; \left[ \sum_{i&#x3D;1}^N \alpha_t(i) a_{ij} \right] b_j(o_{t+1}), 1 \leq t \leq T-1, 1 \leq j \leq N$$</p>
<p><strong>终止</strong>:<br>$$P(O|\lambda) &#x3D; \sum_{i&#x3D;1}^N \alpha_T(i)$$</p>
<h2 id="HMM后向算法-Backward-Algorithm"><a href="#HMM后向算法-Backward-Algorithm" class="headerlink" title="HMM后向算法 (Backward Algorithm)"></a>HMM后向算法 (Backward Algorithm)</h2><p><strong>初始化</strong>:<br>$$\beta_T(i) &#x3D; 1, 1 \leq i \leq N$$</p>
<p><strong>递推</strong>:<br>$$\beta_t(i) &#x3D; \sum_{j&#x3D;1}^N a_{ij} b_j(o_{t+1}) \beta_{t+1}(j), t &#x3D; T-1, T-2, \ldots, 1; 1 \leq i \leq N$$</p>
<p><strong>终止</strong>:<br>$$P(O|\lambda) &#x3D; \sum_{i&#x3D;1}^N \pi_i b_i(o_1) \beta_1(i)$$</p>
<h2 id="维特比算法-Viterbi-Algorithm"><a href="#维特比算法-Viterbi-Algorithm" class="headerlink" title="维特比算法 (Viterbi Algorithm)"></a>维特比算法 (Viterbi Algorithm)</h2><p><strong>初始化</strong>:<br>$$\delta_1(i) &#x3D; \pi_i b_i(o_1), 1 \leq i \leq N$$<br>$$\psi_1(i) &#x3D; 0, 1 \leq i \leq N$$</p>
<p><strong>递推</strong>:<br>$$\delta_t(j) &#x3D; \max_{1 \leq i \leq N} [\delta_{t-1}(i) a_{ij}] b_j(o_t), 2 \leq t \leq T, 1 \leq j \leq N$$<br>$$\psi_t(j) &#x3D; \arg\max_{1 \leq i \leq N} [\delta_{t-1}(i) a_{ij}], 2 \leq t \leq T, 1 \leq j \leq N$$</p>
<p><strong>终止</strong>:<br>$$P^* &#x3D; \max_{1 \leq i \leq N} \delta_T(i)$$<br>$$i_T^* &#x3D; \arg\max_{1 \leq i \leq N} \delta_T(i)$$</p>
<p><strong>路径回溯</strong>:<br>$$i_t^* &#x3D; \psi_{t+1}(i_{t+1}^*), t &#x3D; T-1, T-2, \ldots, 1$$</p>
<h1 id="一种解释"><a href="#一种解释" class="headerlink" title="一种解释"></a>一种解释</h1><h1 id="HMM的袋子与球模型详细解释"><a href="#HMM的袋子与球模型详细解释" class="headerlink" title="HMM的袋子与球模型详细解释"></a>HMM的袋子与球模型详细解释</h1><p>让我们用袋子和球的类比来详细理解隐马尔可夫模型(HMM)的算法。</p>
<h2 id="基本设置"><a href="#基本设置" class="headerlink" title="基本设置"></a>基本设置</h2><ul>
<li>N个袋子，编号为1到N</li>
<li>每个袋子里有M种不同颜色的球</li>
<li>袋子选择序列Q &#x3D; (Q₁, Q₂, …, Qₜ)是隐藏的（我们不知道每次用了哪个袋子）</li>
<li>观察到的球的颜色序列O &#x3D; (O₁, O₂, …, Oₜ)是已知的</li>
</ul>
<h2 id="模型参数"><a href="#模型参数" class="headerlink" title="模型参数"></a>模型参数</h2><ul>
<li>初始概率π：第一次选择每个袋子的概率</li>
<li>转移概率A：从一个袋子移动到另一个袋子的概率，aᵢⱼ表示从袋子i移动到袋子j的概率</li>
<li>发射概率B：每个袋子中抽到各种颜色球的概率，bⱼ(k)表示从袋子j中抽出颜色k的球的概率</li>
</ul>
<h2 id="前向算法详解"><a href="#前向算法详解" class="headerlink" title="前向算法详解"></a>前向算法详解</h2><p><strong>目标</strong>：计算P(O|λ)，即观察到特定颜色序列的概率</p>
<h3 id="前向变量αₜ-i-的含义："><a href="#前向变量αₜ-i-的含义：" class="headerlink" title="前向变量αₜ(i)的含义："></a>前向变量αₜ(i)的含义：</h3><p>αₜ(i)表示到时刻t为止，看到球的颜色序列为O₁,O₂,…,Oₜ，并且t时刻使用的是第i个袋子的联合概率。</p>
<h3 id="1-初始化公式："><a href="#1-初始化公式：" class="headerlink" title="1. 初始化公式："></a>1. 初始化公式：</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">α₁(i) = πᵢ · bᵢ(O₁), 1 ≤ i ≤ N</span><br></pre></td></tr></table></figure>

<p><strong>袋子与球的解释</strong>：</p>
<ul>
<li>πᵢ：第一次选择第i个袋子的概率</li>
<li>bᵢ(O₁)：从第i个袋子中抽出颜色为O₁的球的概率</li>
<li>α₁(i)：第一次选择第i个袋子并从中抽出颜色为O₁的球的概率</li>
</ul>
<p>这表示我们从第i个袋子开始，并且第一次抽球得到了颜色O₁的概率。</p>
<h3 id="2-递推公式："><a href="#2-递推公式：" class="headerlink" title="2. 递推公式："></a>2. 递推公式：</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">αₜ₊₁(j) = [∑ᵢ₌₁ᴺ αₜ(i) · aᵢⱼ] · bⱼ(Oₜ₊₁), 1 ≤ t ≤ T-1, 1 ≤ j ≤ N</span><br></pre></td></tr></table></figure>

<p><strong>袋子与球的解释</strong>：</p>
<ul>
<li>αₜ(i)：前t次抽球，看到序列O₁,…,Oₜ且t时刻在袋子i的概率</li>
<li>aᵢⱼ：从袋子i转移到袋子j的概率</li>
<li>αₜ(i) · aᵢⱼ：前t次抽球，看到序列O₁,…,Oₜ且t时刻在袋子i，然后转移到袋子j的概率</li>
<li>∑ᵢ₌₁ᴺ αₜ(i) · aᵢⱼ：前t次抽球，看到序列O₁,…,Oₜ且t+1时刻在袋子j的概率（无论t时刻在哪个袋子）</li>
<li>bⱼ(Oₜ₊₁)：从袋子j抽出颜色为Oₜ₊₁的球的概率</li>
<li>整个公式：前t+1次抽球，看到序列O₁,…,Oₜ,Oₜ₊₁且t+1时刻在袋子j的概率</li>
</ul>
<p>这个递推公式表示：要计算t+1时刻在袋子j的概率，我们考虑t时刻可能在任何袋子i，然后从i转移到j，再从j抽出颜色为Oₜ₊₁的球的所有可能性之和。</p>
<h3 id="3-终止公式："><a href="#3-终止公式：" class="headerlink" title="3. 终止公式："></a>3. 终止公式：</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">P(O|λ) = ∑ᵢ₌₁ᴺ αₜ(i)</span><br></pre></td></tr></table></figure>

<p><strong>袋子与球的解释</strong>：</p>
<ul>
<li>αₜ(i)：整个观测序列结束时在袋子i的概率</li>
<li>∑ᵢ₌₁ᴺ αₜ(i)：整个观测序列的概率，无论最后是在哪个袋子</li>
</ul>
<p>这个终止公式将所有可能的最终袋子情况求和，得到整个观测序列的总概率。</p>
<h2 id="后向算法详解"><a href="#后向算法详解" class="headerlink" title="后向算法详解"></a>后向算法详解</h2><p><strong>目标</strong>：同样计算P(O|λ)，但从反向考虑</p>
<h3 id="后向变量βₜ-i-的含义："><a href="#后向变量βₜ-i-的含义：" class="headerlink" title="后向变量βₜ(i)的含义："></a>后向变量βₜ(i)的含义：</h3><p>βₜ(i)表示在t时刻使用第i个袋子的条件下，未来观察到球的颜色序列Oₜ₊₁,Oₜ₊₂,…,Oₜ的条件概率。</p>
<h3 id="1-初始化公式：-1"><a href="#1-初始化公式：-1" class="headerlink" title="1. 初始化公式："></a>1. 初始化公式：</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">βₜ(i) = 1, 1 ≤ i ≤ N</span><br></pre></td></tr></table></figure>

<p><strong>袋子与球的解释</strong>：</p>
<ul>
<li>在最后时刻T，没有未来的观测，所以无论是哪个袋子，概率都为1</li>
</ul>
<p>这表示无论最后使用哪个袋子，没有更多的球要抽了，所以概率都是1。</p>
<h3 id="2-递推公式：-1"><a href="#2-递推公式：-1" class="headerlink" title="2. 递推公式："></a>2. 递推公式：</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">βₜ(i) = ∑ⱼ₌₁ᴺ aᵢⱼ · bⱼ(Oₜ₊₁) · βₜ₊₁(j), t = T-1, T-2, ..., 1; 1 ≤ i ≤ N</span><br></pre></td></tr></table></figure>

<p><strong>袋子与球的解释</strong>：</p>
<ul>
<li>aᵢⱼ：从袋子i转移到袋子j的概率</li>
<li>bⱼ(Oₜ₊₁)：从袋子j抽出颜色为Oₜ₊₁的球的概率</li>
<li>βₜ₊₁(j)：t+1时刻在袋子j的条件下，观察到未来球的颜色序列Oₜ₊₂,…,Oₜ的概率</li>
<li>aᵢⱼ · bⱼ(Oₜ₊₁) · βₜ₊₁(j)：t时刻在袋子i，转移到袋子j，从j抽出颜色为Oₜ₊₁的球，然后观察到剩余序列的概率</li>
<li>∑ⱼ₌₁ᴺ […]：考虑所有可能的下一个袋子j</li>
</ul>
<p>这个递推公式表示：在t时刻使用袋子i的条件下，未来观察到指定颜色序列的概率，是考虑所有可能的下一个袋子转移、下一次抽球和剩余未来序列的可能性之和。</p>
<h3 id="3-终止公式：-1"><a href="#3-终止公式：-1" class="headerlink" title="3. 终止公式："></a>3. 终止公式：</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">P(O|λ) = ∑ᵢ₌₁ᴺ πᵢ · bᵢ(O₁) · β₁(i)</span><br></pre></td></tr></table></figure>

<p><strong>袋子与球的解释</strong>：</p>
<ul>
<li>πᵢ：第一次选择袋子i的概率</li>
<li>bᵢ(O₁)：从袋子i抽出颜色为O₁的球的概率</li>
<li>β₁(i)：在第一时刻使用袋子i的条件下，观察到未来球的颜色序列O₂,…,Oₜ的概率</li>
<li>整个公式：考虑所有可能的第一个袋子，计算观察到整个颜色序列的总概率</li>
</ul>
<p>这个终止公式从第一个时刻开始，考虑所有可能的初始袋子，计算观察到整个序列的概率。</p>
<h2 id="维特比算法详解"><a href="#维特比算法详解" class="headerlink" title="维特比算法详解"></a>维特比算法详解</h2><p><strong>目标</strong>：找出最可能的袋子序列</p>
<h3 id="变量含义："><a href="#变量含义：" class="headerlink" title="变量含义："></a>变量含义：</h3><ul>
<li>δₜ(i)：到t时刻为止，观察到序列O₁,…,Oₜ，并且t时刻使用袋子i的所有可能路径中的最大概率</li>
<li>ψₜ(i)：记录t时刻使用袋子i的最可能路径中，t-1时刻使用的袋子</li>
</ul>
<h3 id="1-初始化公式：-2"><a href="#1-初始化公式：-2" class="headerlink" title="1. 初始化公式："></a>1. 初始化公式：</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">δ₁(i) = πᵢ · bᵢ(O₁), 1 ≤ i ≤ N</span><br><span class="line">ψ₁(i) = 0, 1 ≤ i ≤ N</span><br></pre></td></tr></table></figure>

<p><strong>袋子与球的解释</strong>：</p>
<ul>
<li>δ₁(i)：第一次选择袋子i并从中抽出颜色为O₁的球的概率</li>
<li>ψ₁(i) &#x3D; 0：第一个时刻没有前导袋子，所以设为0</li>
</ul>
<p>这表示在第一个时刻，选择每个袋子的概率就是初始概率与发射概率的乘积。</p>
<h3 id="2-递推公式：-2"><a href="#2-递推公式：-2" class="headerlink" title="2. 递推公式："></a>2. 递推公式：</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">δₜ(j) = max₁≤ᵢ≤ₙ[δₜ₋₁(i) · aᵢⱼ] · bⱼ(Oₜ), 2 ≤ t ≤ T, 1 ≤ j ≤ N</span><br><span class="line">ψₜ(j) = arg max₁≤ᵢ≤ₙ[δₜ₋₁(i) · aᵢⱼ], 2 ≤ t ≤ T, 1 ≤ j ≤ N</span><br></pre></td></tr></table></figure>

<p><strong>袋子与球的解释</strong>：</p>
<ul>
<li>δₜ₋₁(i)：t-1时刻在袋子i的最大概率</li>
<li>aᵢⱼ：从袋子i转移到袋子j的概率</li>
<li>δₜ₋₁(i) · aᵢⱼ：从t-1时刻的袋子i转移到t时刻的袋子j的概率</li>
<li>max₁≤ᵢ≤ₙ[δₜ₋₁(i) · aᵢⱼ]：所有可能的前导袋子中，产生最大概率的那个</li>
<li>bⱼ(Oₜ)：从袋子j抽出颜色为Oₜ的球的概率</li>
<li>δₜ(j)：综合考虑前导袋子、转移概率和发射概率后，t时刻在袋子j的最大概率</li>
<li>ψₜ(j)：记录哪个前导袋子i产生了这个最大概率</li>
</ul>
<p>这两个公式表示：在t时刻，对于每个可能的袋子j，我们找出从哪个前导袋子i转移过来的概率最大，并记录这个i。</p>
<h3 id="3-终止公式：-2"><a href="#3-终止公式：-2" class="headerlink" title="3. 终止公式："></a>3. 终止公式：</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">P* = max₁≤ᵢ≤ₙ[δₜ(i)]</span><br><span class="line">i*ₜ = arg max₁≤ᵢ≤ₙ[δₜ(i)]</span><br></pre></td></tr></table></figure>

<p><strong>袋子与球的解释</strong>：</p>
<ul>
<li>P*：最可能路径的概率</li>
<li>i*ₜ：最可能路径中最后一个袋子的编号</li>
</ul>
<p>这表示我们找出最后时刻哪个袋子能产生最大的概率，这就是最可能路径的终点。</p>
<h3 id="4-路径回溯："><a href="#4-路径回溯：" class="headerlink" title="4. 路径回溯："></a>4. 路径回溯：</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">i*ₜ = ψₜ₊₁(i*ₜ₊₁), t = T-1, T-2, ..., 1</span><br></pre></td></tr></table></figure>

<p><strong>袋子与球的解释</strong>：</p>
<ul>
<li>i*ₜ₊₁：t+1时刻的最优袋子</li>
<li>ψₜ₊₁(i*ₜ₊₁)：根据记录找出t时刻的最优袋子</li>
<li>整个回溯过程：从最后时刻开始，逐步向前找出每个时刻的最优袋子</li>
</ul>
<p>这个回溯过程使用我们之前记录的ψₜ(j)信息，从最后一个袋子开始，逐步向前找出每个时刻最可能使用的袋子，最终得到整个最可能的袋子序列Q* &#x3D; (Q<em>₁, Q</em>₂, …, Q*ₜ)。</p>
<p>通过这种袋子与球的类比，希望能够更形象地理解HMM的三个重要算法。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2025/03/12/HMM-viterbi/" data-id="cm8ga9g140000ugyd6zg67hzr" data-title="" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2025/03/13/%E9%98%BF%E9%87%8C%E7%AB%9E%E8%B5%9B2023_%E9%83%A8%E5%88%86%E4%B9%A0%E9%A2%98/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          (no title)
        
      </div>
    </a>
  
  
    <a href="/2024/12/30/%E7%8B%AC%E4%BA%BA%E8%84%89%E6%84%9F%E6%83%B3/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title"></div>
    </a>
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/03/">March 2025</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/12/">December 2024</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2025/03/22/ROS_%E7%AE%97%E6%B3%95/">(no title)</a>
          </li>
        
          <li>
            <a href="/2025/03/20/%E6%88%91%E7%9A%84%E9%83%A8%E5%88%86%E8%A7%A3%E7%AD%94%E6%80%9D%E8%B7%AF/">(no title)</a>
          </li>
        
          <li>
            <a href="/2025/03/13/%E9%98%BF%E9%87%8C%E7%AB%9E%E8%B5%9B2023_%E9%83%A8%E5%88%86%E4%B9%A0%E9%A2%98/">(no title)</a>
          </li>
        
          <li>
            <a href="/2025/03/12/HMM-viterbi/">(no title)</a>
          </li>
        
          <li>
            <a href="/2024/12/30/%E7%8B%AC%E4%BA%BA%E8%84%89%E6%84%9F%E6%83%B3/">(no title)</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2025 John Doe<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.6.4.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>